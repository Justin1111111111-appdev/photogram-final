<div>
  <div>
    <h1>
      List of users
    </h1>
  </div>
</div>


<div>
  <div>
    <table border="1">
      <tr>
        <th>
          Username
        </th>

        <th>
          Private?
        </th>

         <th>
        </th>

        <th>
        </th>

      </tr>

      <% @list_of_users.each do |a_user| %>
      <tr>
        <td>
          <%= a_user.username %>
        </td>
        <td>
          <%= a_user.private ? "Yes" : "No" %>
        </td>

    <% if @current_user  %> 
    <% request = FollowRequest.find_by(sender_id: @current_user.id, recipient_id: a_user.id)  %>
      <% if request.nil? %>
        <td>
            <form action="/insert_follow_request" method="post">
              <input type="hidden" name="query_recipient_id" value="<%= a_user.id %>">
              <input type="hidden" name="query_sender_id" value="<%= @current_user.id %>">
              <input type="hidden" name="query_status_id" value="pending">
              <button>
                Follow
              </button>
            </form>
          </td>
          
        <% elsif @the_user.private %>
             Request sent. <a href="/delete_follow_request/<%= a_user.id %>"> Cancel</a>

        <% else %>
            <a href="/delete_follow_request/<%= a_user.id %>"> Unfollow</a>
        <% end %>
      <% end %>
         <td>
          <a href="/users/<%= a_user.id %>">
            Show details
          </a>
        </td>
      </tr>
      <% end %>
    </table>
  </div>
</div>
